<!DOCTYPE html>
<!-- index.html_V2.5.2 -->
<!-- Version: V2.5.2 - Inline styles and scripts -->
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Home Automation 3D Carousel (V2.5.2)</title>
  <style>
    :root {
      --bg-color: #000;
      --card-bg: #1e1e1e;
      --text-color: #eee;
      --accent: #f5a623;
    }

    body {
      margin: 0;
      font-family: sans-serif;
      background: var(--bg-color);
      color: var(--text-color);
      overflow: hidden;
    }

    body.light-theme {
      --bg-color: #f0f0f0;
      --card-bg: #ffffff;
      --text-color: #000000;
    }

    header {
      text-align: center;
      margin: 1rem 0;
    }

    .carousel-container {
      width: 100%;
      perspective: 800px;
      height: 200px;
      position: relative;
      margin: 2rem auto;
    }

    .carousel {
      width: 100%;
      height: 100%;
      transform-style: preserve-3d;
      position: relative;
      transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
      will-change: transform;
    }

    .card {
      width: 100px;
      height: 140px;
      background: var(--card-bg);
      border-radius: 6px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      position: absolute;
      top: 50%;
      left: 50%;
      opacity: 0.8;
      transform: translate(-50%, -50%);
      transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.6s ease;
      will-change: transform;
      box-shadow: 0 2px 3px rgba(0, 0, 0, 0.1);
      backface-visibility: hidden;
    }

    .card.active {
      opacity: 1;
      box-shadow: 0 0 0 6px rgba(245,166,35,0.5);
      transform: translate(-50%, -50%) scale(1.1);
      cursor: pointer;
    }

    .card-icon {
      font-size: 3rem;
    }

    .card-title {
      margin-top: 1rem;
      font-size: 1rem;
    }

    .dots {
      display: flex;
      justify-content: center;
      margin-top: 0.75rem;
    }

    .dot {
      width: 10px;
      height: 10px;
      background: #999;
      border-radius: 50%;
      margin: 0 5px;
      cursor: pointer;
    }

    .dot.active {
      background: var(--accent);
    }

    .nav-button {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      font-size: 2rem;
      background: rgba(0,0,0,0.5);
      color: white;
      border: none;
      padding: 1rem;
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.3s ease;
      z-index: 10;
    }

    .nav-button:hover {
      background: rgba(0,0,0,0.7);
      transform: translateY(-50%) scale(1.1);
    }

    .nav-prev { left: 10%; }
    .nav-next { right: 10%; }

    .login-box {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0,0,0,0.9);
      padding: 2rem;
      border-radius: 1rem;
      z-index: 1000;
    }

    .login-box input {
      display: block;
      width: 100%;
      margin: 1rem 0;
      padding: 0.5rem;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 1rem;
    }

    .login-box button {
      width: 100%;
      padding: 0.5rem;
      background: var(--accent);
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 1rem;
    }

    .loading-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }

    .spinner {
      width: 50px;
      height: 50px;
      border: 5px solid #f3f3f3;
      border-top: 5px solid var(--accent);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <header>
    <h1 style="margin: 0;">Home Automation</h1>
    <p style="margin: 0;">Use the arrows or ‚Üê/‚Üí keys to spin the wheel</p>
  </header>
  
  <!-- Login Info Panel -->
  <div id="loginInfoPanel" style="position: fixed; top: 1rem; right: 1rem; background: rgba(0,0,0,0.7); padding: 1rem; border-radius: 6px; z-index: 1000; color: var(--text-color); display: none;">
    <div id="welcomeMessage" style="font-size: 1.2rem; margin-bottom: 0.5rem;"></div>
    <div id="loginTime" style="font-size: 0.9rem; margin-bottom: 0.5rem;"></div>
    <div id="loginIP" style="font-size: 0.9rem; margin-bottom: 0.5rem;"></div>
    <button id="logoutBtn" style="background: var(--accent); color: var(--text-color); border: none; padding: 0.5rem 1rem; border-radius: 4px; cursor: pointer; font-weight: bold; box-shadow: 0 2px 4px rgba(0,0,0,0.2); width: 100%; margin-top: 0.5rem;">Logout</button>
  </div>

  <div class="carousel-container">
    <button class="nav-button nav-prev" id="prevBtn" aria-label="Previous">&#8249;</button>
    <div class="carousel" id="carousel"></div>
    <button class="nav-button nav-next" id="nextBtn" aria-label="Next">&#8250;</button>
  </div>
  <div class="dots" id="dots"></div>

  <div id="loginBox" class="login-box">
    <h2>üîí Access Required</h2>
    <input type="text" id="username" placeholder="Username" />
    <input type="password" id="password" placeholder="Password" />
    <button id="loginBtn">Login</button>
  </div>

  <button id="themeToggle" aria-label="Toggle theme">üåô</button>

  <div class="loading-overlay">
    <div class="spinner"></div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const pages = {
        audio: `<div class="page-content">
          <h1>Audio Devices</h1>
          <p>Control your home audio system here.</p>
          <div class="controls">
            <button>Play</button>
            <button>Pause</button>
            <button>Stop</button>
          </div>
        </div>`,
        lighting: `<div class="page-content">
          <h1>Lighting</h1>
          <p>Adjust lights and scenes here.</p>
          <div class="controls">
            <button>On</button>
            <button>Off</button>
            <button>Dim</button>
          </div>
        </div>`,
        climate: `<div class="page-content">
          <h1>Climate</h1>
          <p>Manage temperature and HVAC here.</p>
          <div class="controls">
            <button>Heat</button>
            <button>Cool</button>
            <button>Fan</button>
          </div>
        </div>`,
        security: `<div class="page-content">
          <h1>Security</h1>
          <p>Monitor and control security systems here.</p>
          <div class="controls">
            <button>Arm</button>
            <button>Disarm</button>
            <button>Check Status</button>
          </div>
        </div>`,
        settings: `<div class="page-content">
          <h1>Settings</h1>
          <p>Configure system preferences here.</p>
          <div class="controls">
            <button>General</button>
            <button>Security</button>
            <button>Network</button>
          </div>
        </div>`,
        entertainment: `<div class="page-content">
          <h1>Entertainment</h1>
          <p>Control media devices here.</p>
          <div class="controls">
            <button>TV</button>
            <button>Streaming</button>
            <button>Games</button>
          </div>
        </div>`,
        energy: `<div class="page-content">
          <h1>Energy</h1>
          <p>Monitor power usage here.</p>
          <div class="controls">
            <button>Usage</button>
            <button>Cost</button>
            <button>History</button>
          </div>
        </div>`,
        water: `<div class="page-content">
          <h1>Water</h1>
          <p>Control water systems here.</p>
          <div class="controls">
            <button>On</button>
            <button>Off</button>
            <button>Monitor</button>
          </div>
        </div>`,
        devices: `<div class="page-content">
          <h1>Devices</h1>
          <p>Manage connected devices here.</p>
          <div class="controls">
            <button>Connected</button>
            <button>Disconnected</button>
            <button>Update</button>
          </div>
        </div>`,
        home: `<div class="page-content">
          <h1>Home</h1>
          <p>Quick access to home controls.</p>
          <div class="controls">
            <button>Quick Actions</button>
            <button>Scenes</button>
            <button>Favorites</button>
          </div>
        </div>`
      };

      const data = Object.entries(pages).map(([key, content]) => ({
        icon: key === 'settings' ? '‚öôÔ∏è' : key === 'audio' ? 'üéµ' : key === 'lighting' ? 'üí°' : key === 'climate' ? 'üå°Ô∏è' : key === 'security' ? 'üîí' : key === 'entertainment' ? 'üì∫' : key === 'energy' ? 'üîã' : key === 'water' ? 'üíß' : key === 'devices' ? 'üì±' : 'üè†',
        title: key.charAt(0).toUpperCase() + key.slice(1),
        key,
        description: `Control ${key} here.`
      }));

      // Initialize constants
      const CARDS = data.length;
      const ANGLE = 360 / CARDS;
      let index = 0;

      // Get DOM elements
      const elements = {
        carousel: document.querySelector('.carousel'),
        dotsContainer: document.querySelector('.dots'),
        prevBtn: document.getElementById('prevBtn'),
        nextBtn: document.getElementById('nextBtn'),
        loginBtn: document.getElementById('loginBtn'),
        logoutBtn: document.getElementById('logoutBtn'),
        loginBox: document.getElementById('loginBox'),
        loginInfoPanel: document.getElementById('loginInfoPanel'),
        welcomeMessage: document.getElementById('welcomeMessage'),
        loginTime: document.getElementById('loginTime'),
        loginIP: document.getElementById('loginIP'),
        themeToggle: document.getElementById('themeToggle'),
        loadingOverlay: document.querySelector('.loading-overlay')
      };

      // Initialize theme
      const savedTheme = localStorage.getItem('theme') || 'dark';
      if (savedTheme === 'dark') {
        document.body.classList.add('dark-theme');
        elements.themeToggle.textContent = '‚òÄÔ∏è';
      } else {
        document.body.classList.remove('dark-theme');
        elements.themeToggle.textContent = 'üåô';
      }

      // Theme toggle
      elements.themeToggle.onclick = () => {
        const isDark = document.body.classList.toggle('dark-theme');
        localStorage.setItem('theme', isDark ? 'dark' : 'light');
        elements.themeToggle.textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
      };

      const cards = data.map((item, i) => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `<div class="card-icon">${item.icon}</div><div class="card-title">${item.title}</div>`;
        carousel.appendChild(card);

        const dot = document.createElement('div');
        dot.className = 'dot';
        dot.addEventListener('click', () => {
          index = i;
          render();
        });
        dotsContainer.appendChild(dot);
        return card;
      });

      function render() {
        cards.forEach((card, i) => {
          let offset = i - index;
          if (offset > CARDS / 2) offset -= CARDS;
          if (offset < -CARDS / 2) offset += CARDS;

          const deg = offset * ANGLE;
          const z = Math.abs(offset) <= 1 ? 340 : (Math.abs(offset) <= 2 ? 280 : 220);
          const scale = Math.abs(offset) <= 1 ? 1.1 : (Math.abs(offset) <= 2 ? 0.9 : 0.7);
          const opacity = Math.abs(offset) <= 2 ? 1 : 0.8;

          card.style.transform = `translate(-50%, -50%) rotateY(${deg}deg) translateZ(${z}px) scale(${scale})`;
          card.style.opacity = opacity;
          card.classList.toggle('active', offset === 0);

          if (offset === 0) {
            card.onclick = async () => {
              const loadingOverlay = document.querySelector('.loading-overlay');
              loadingOverlay.style.display = 'flex';
              try {
                const username = localStorage.getItem('username');
                if (!username) {
                  document.getElementById('loginBox').style.display = 'flex';
                  return;
                }

                // Simulate API call
                await new Promise(resolve => setTimeout(resolve, 500));
                
                // Navigate to page
                const page = data[index].key;
                window.location.hash = `#${page}`;
                
                // Create page container with inline content
                const pageContainer = document.createElement('div');
                pageContainer.id = 'pageContainer';
                pageContainer.innerHTML = pages[page];
                
                // Add styles for page content
                pageContainer.style.cssText = `
                  position: absolute;
                  top: 0;
                  left: 0;
                  width: 100%;
                  height: 100%;
                  background: var(--bg-color);
                  color: var(--text-color);
                  display: flex;
                  flex-direction: column;
                  align-items: center;
                  padding: 2rem;
                  box-sizing: border-box;
                `;
                
                // Add to body and show
                document.body.appendChild(pageContainer);
                pageContainer.style.display = 'block';
                
                // Hide carousel and other elements
                document.querySelector('.carousel-container').style.display = 'none';
                document.querySelector('.dots').style.display = 'none';
                document.getElementById('themeToggle').style.display = 'none';
                
                // Add back button
                const backButton = document.createElement('button');
                backButton.textContent = '‚Üê Back to Carousel';
                backButton.style.cssText = `
                  position: fixed;
                  top: 1rem;
                  left: 1rem;
                  background: var(--card-bg);
                  color: var(--text-color);
                  border: none;
                  padding: 0.5rem 1rem;
                  border-radius: 4px;
                  cursor: pointer;
                  z-index: 1000;
                `;
                backButton.onclick = () => {
                  // Remove page container and show carousel
                  pageContainer.remove();
                  backButton.remove();
                  document.querySelector('.carousel-container').style.display = '';
                  document.querySelector('.dots').style.display = '';
                  document.getElementById('themeToggle').style.display = '';
                  window.location.hash = '';
                };
                document.body.appendChild(backButton);
              } catch (error) {
                console.error('Error:', error);
                alert('Failed to load page: ' + error.message);
              } finally {
                loadingOverlay.style.display = 'none';
              }
            };
          }
        });

        const dots = dotsContainer.querySelectorAll('.dot');
        dots.forEach((dot, i) => dot.classList.toggle('active', i === index));
      }

      // Initialize carousel
      render();

      // Add navigation handlers
      document.getElementById('prevBtn').onclick = () => {
        index = (index - 1 + CARDS) % CARDS;
        render();
      };

      document.getElementById('nextBtn').onclick = () => {
        index = (index + 1) % CARDS;
        render();
      };

      // Add keyboard navigation
      document.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowLeft') {
          document.getElementById('prevBtn').click();
        } else if (e.key === 'ArrowRight') {
          document.getElementById('nextBtn').click();
        }
      });

      // Add touch support
      // Touch support
      carousel.addEventListener('touchstart', (e) => {
        const touchStartX = e.touches[0].clientX;
        
        carousel.addEventListener('touchend', (e) => {
          const touchEndX = e.changedTouches[0].clientX;
          const diff = touchStartX - touchEndX;
          if (Math.abs(diff) > 50) { // Threshold for swipe
            if (diff > 0) {
              document.getElementById('nextBtn').click();
            } else {
              document.getElementById('prevBtn').click();
            }
          }
        }, { once: true });
      });

      // Add theme toggle
        index = i;
        render();
      document.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowLeft') prevBtn.click();
        if (e.key === 'ArrowRight') nextBtn.click();
      });

      // Touch support
      let touchStartX = 0;
      carousel.addEventListener('touchstart', (e) => {
        touchStartX = e.touches[0].clientX;
      });
      carousel.addEventListener('touchmove', (e) => {
        const touchMoveX = e.touches[0].clientX;
        if (touchMoveX - touchStartX > 50) prevBtn.click();
      document.getElementById('themeToggle').onclick = () => {
        const isDark = document.body.classList.toggle('dark-theme');
        localStorage.setItem('theme', isDark ? 'dark' : 'light');
        document.getElementById('themeToggle').textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
      };

      // Check login status and initialize authentication
      const loginBtn = document.getElementById('loginBtn');
      const logoutBtn = document.getElementById('logoutBtn');
      const loginBox = document.getElementById('loginBox');
      const loginInfoPanel = document.getElementById('loginInfoPanel');
      const welcomeMessage = document.getElementById('welcomeMessage');
      const loginTime = document.getElementById('loginTime');
      const loginIP = document.getElementById('loginIP');

      const user = localStorage.getItem('username');
      if (!user) {
        loginBox.style.display = 'flex';
        loginInfoPanel.style.display = 'none';
      } else {
        const time = localStorage.getItem('loginTime');
        const now = Date.now();
        if (now - time > 3600000) { // 1 hour session
          localStorage.removeItem('username');
          localStorage.removeItem('loginTime');
          loginBox.style.display = 'flex';
          loginInfoPanel.style.display = 'none';
        } else {
          loginInfoPanel.style.display = 'block';
          welcomeMessage.textContent = `Welcome, ${user}`;
          const loginTimeObj = new Date(time);
          loginTime.textContent = `Last login: ${loginTimeObj.getFullYear()} ${loginTimeObj.getMonth() + 1} ${loginTimeObj.getDate()}, ${loginTimeObj.toLocaleTimeString()}`;
          loginIP.textContent = 'Last login from IP: 127.0.0.1'; // Placeholder IP
        }
      }

      // Add authentication handlers
      loginBtn.onclick = () => {
        const username = document.getElementById('username').value;
        const password = document.getElementById('password').value;
        
        if (username && password) {
          localStorage.setItem('username', username);
          localStorage.setItem('loginTime', Date.now());
          loginBox.style.display = 'none';
          loginInfoPanel.style.display = 'block';
          
          // Update login info
          welcomeMessage.textContent = `Welcome, ${username}`;
          const loginTimeObj = new Date(localStorage.getItem('loginTime'));
          loginTime.textContent = `Last login: ${loginTimeObj.getFullYear()} ${loginTimeObj.getMonth() + 1} ${loginTimeObj.getDate()}, ${loginTimeObj.toLocaleTimeString()}`;
          loginIP.textContent = 'Last login from IP: 127.0.0.1'; // Placeholder IP
        } else {
          alert('Please enter both username and password');
        }
      };

      logoutBtn.onclick = () => {
        localStorage.removeItem('username');
        localStorage.removeItem('loginTime');
        loginInfoPanel.style.display = 'none';
        loginBox.style.display = 'flex';
        
        // Reset page if viewing one
        const pageContainer = document.getElementById('pageContainer');
        if (pageContainer) {
          pageContainer.remove();
          document.querySelector('.carousel-container').style.display = '';
          document.querySelector('.dots').style.display = '';
          document.getElementById('themeToggle').style.display = '';
          window.location.hash = '';
        }
      };

      // Initialize carousel
      render();

      // Add navigation handlers
      prevBtn.onclick = () => {
        index = (index - 1 + CARDS) % CARDS;
        render();
      };

      nextBtn.onclick = () => {
        index = (index + 1) % CARDS;
        render();
      };

      // Add keyboard navigation
      document.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowLeft') prevBtn.click();
        if (e.key === 'ArrowRight') nextBtn.click();
      });

      // Add touch support
      carousel.addEventListener('touchstart', (e) => {
        const touchStartX = e.touches[0].clientX;
        
        carousel.addEventListener('touchend', (e) => {
          const touchEndX = e.changedTouches[0].clientX;
          const diff = touchStartX - touchEndX;
          if (Math.abs(diff) > 50) { // Threshold for swipe
            if (diff > 0) {
              nextBtn.click();
            } else {
              prevBtn.click();
            }
          }
        }, { once: true });
      });

      // Initialize login status
      const currentUser = localStorage.getItem('username');
      if (!currentUser) {
        elements.loginBox.style.display = 'flex';
        elements.loginInfoPanel.style.display = 'none';
      } else {
        const time = localStorage.getItem('loginTime');
        const now = Date.now();
        if (now - time > 3600000) { // 1 hour session
          localStorage.removeItem('username');
          localStorage.removeItem('loginTime');
          elements.loginBox.style.display = 'flex';
          elements.loginInfoPanel.style.display = 'none';
        } else {
          elements.loginInfoPanel.style.display = 'block';
          elements.welcomeMessage.textContent = `Welcome, ${currentUser}`;
          const loginTimeObj = new Date(time);
          elements.loginTime.textContent = `Last login: ${loginTimeObj.getFullYear()} ${loginTimeObj.getMonth() + 1} ${loginTimeObj.getDate()}, ${loginTimeObj.toLocaleTimeString()}`;
          elements.loginIP.textContent = 'Last login from IP: 127.0.0.1'; // Placeholder IP
          elements.logoutBtn.style.display = 'block';
        }
      }

      // Add authentication handlers
      elements.loginBtn.onclick = () => {
        const username = document.getElementById('username').value;
        const password = document.getElementById('password').value;
        
        if (username && password) {
          localStorage.setItem('username', username);
          localStorage.setItem('loginTime', Date.now());
          elements.loginBox.style.display = 'none';
          elements.loginInfoPanel.style.display = 'block';
          
          // Update login info
          elements.welcomeMessage.textContent = `Welcome, ${username}`;
          const loginTimeObj = new Date(localStorage.getItem('loginTime'));
          elements.loginTime.textContent = `Last login: ${loginTimeObj.getFullYear()} ${loginTimeObj.getMonth() + 1} ${loginTimeObj.getDate()}, ${loginTimeObj.toLocaleTimeString()}`;
          elements.loginIP.textContent = 'Last login from IP: 127.0.0.1'; // Placeholder IP
          elements.logoutBtn.style.display = 'block';
        } else {
          alert('Please enter both username and password');
        }
      };

      elements.logoutBtn.onclick = () => {
        localStorage.removeItem('username');
        localStorage.removeItem('loginTime');
        elements.loginInfoPanel.style.display = 'none';
        elements.loginBox.style.display = 'flex';
        elements.logoutBtn.style.display = 'none';
        elements.welcomeMessage.textContent = '';
        elements.loginTime.textContent = '';
        elements.loginIP.textContent = '';
        
        // Reset page if viewing one
        const pageContainer = document.getElementById('pageContainer');
        if (pageContainer) {
          pageContainer.remove();
          document.querySelector('.carousel-container').style.display = '';
          document.querySelector('.dots').style.display = '';
          elements.themeToggle.style.display = '';
          window.location.hash = '';
        }
      };
    });
  </script>
</body>
</html>
